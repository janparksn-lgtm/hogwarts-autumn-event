<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>¬´–ù–∞–π–¥–∏ –ø–∞—Ä—É¬ª</title>
<style>
  :root{
    --bg:#1a1625; --card:#261e36; --ink:#f7f2e8; --ink-dim:#cfc6b4; --grid:#3a2f4d;
    --accent:#f0a202; --success:#50c878; --warn:#d84315;
  }
  html,body{height:100%}
  body{
    margin:0; color:var(--ink);
    font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Inter, Arial, sans-serif;
    background:
      radial-gradient(1400px 900px at 10% -10%, #2a223e 0%, var(--bg) 60%),
      url('data:image/svg+xml;utf8,<svg xmlns=%22http://www.w3.org/2000/svg%22 width=%2248%22 height=%2248%22><text x=%220%22 y=%2236%22 font-size=%2232%22>üïØÔ∏è</text></svg>');
    background-blend-mode:multiply;
  }
  .wrap{max-width:980px; margin:28px auto; padding:16px; position:relative}

  /* –ë–µ–ª–∞—è –Ω–µ–ø—Ä–æ–∑—Ä–∞—á–Ω–∞—è —à–∞–ø–∫–∞ */
  .head{
    background:#fff;
    color:#2a223e;
    border:1px solid var(--grid);
    border-radius:18px; padding:12px 14px; margin-bottom:14px;
    display:flex; align-items:center; justify-content:space-between; gap:12px; flex-wrap:wrap;
  }
  .title{display:flex; align-items:center; gap:12px}
  .mug{width:42px; height:42px; border-radius:10px; display:grid; place-items:center; background:
      linear-gradient(180deg,#f9f3d1,#f1d58a 60%, #e3b04a),
      radial-gradient(circle at 50% 0%, #fff 0 40%, transparent 41%);
    box-shadow: inset 0 -10px 18px rgba(0,0,0,.2), 0 6px 20px rgba(0,0,0,.3); color:#5a3b00; font-size:22px}
  h1{font-size:18px; margin:0}

  .controls{display:flex; gap:8px; align-items:center; flex-wrap:wrap}
  button{appearance:none; border:1px solid #4a3a63; background:#33294a; color:var(--ink); padding:8px 12px; border-radius:10px; font:600 12px/1 ui-sans-serif,system-ui; cursor:pointer; transition:.2s; box-shadow:0 2px 0 rgba(0,0,0,.25)}
  button:hover{transform:translateY(-1px)}

  .hud{display:flex; gap:12px; align-items:center; flex-wrap:wrap}
  .pill{padding:6px 10px; border-radius:999px; background:#2a203b; border:1px solid var(--grid); font-size:12px; color:var(--ink)}

  .board{--cols:6; display:grid; grid-template-columns:repeat(var(--cols), minmax(70px,1fr)); gap:10px;
         background:var(--card); border:1px solid var(--grid); border-radius:16px; padding:14px}

  .card{
    position:relative; aspect-ratio: 3 / 4; border:1px solid var(--grid); border-radius:12px;
    background:#251d39; cursor:pointer; perspective: 900px;
    -webkit-tap-highlight-color: transparent;
  }
  .card.disabled{pointer-events:none; opacity:.9}
  .inner{position:absolute; inset:0; transform-style:preserve-3d; transition: transform .35s cubic-bezier(.2,.6,.2,1)}
  .flipped .inner{transform: rotateY(180deg)}
  .face{position:absolute; inset:0; display:grid; place-items:center; backface-visibility: hidden; border-radius:12px}
  .front{background:
      radial-gradient(200px 120px at 50% -30px, rgba(255,255,255,.08), transparent 60%),
      repeating-linear-gradient(135deg, #2e2740, #2e2740 12px, #2a213b 12px, #2a213b 24px);
    border:1px solid #4a3a63}
  .front::after{content:''; position:absolute; inset:10px; border-radius:10px; border:1px dashed #614f7f}
  .back{transform: rotateY(180deg); background: #1e162c; border:1px solid #4a3a63}
  .emoji{font-size:34px; filter: drop-shadow(0 6px 10px rgba(0,0,0,.4))}
  .matched .back{box-shadow: inset 0 0 0 999px rgba(80,200,120,.08)}
  .matched .inner{animation: pop .35s ease}
  @keyframes pop{ from{ transform: rotateY(180deg) scale(.9) } to{ transform: rotateY(180deg) scale(1) } }

  /* –û–≤–µ—Ä–ª–µ–π –ø–æ–≤–µ—Ä—Ö –ø–æ–ª—è */
  .overlay{
    position:fixed; inset:0; display:flex; align-items:center; justify-content:center;
    background: rgba(0,0,0,.55);
    padding: 24px;
    z-index: 1000;
  }
  .overlay.is-hidden{ display:none !important; }
  .dialog{
    width:min(520px, 92vw);
    background:#231d35; color:var(--ink);
    border:1px solid var(--grid); border-radius:16px; padding:18px;
    box-shadow: 0 20px 60px rgba(0,0,0,.35);
  }
  .dialog h2{margin:0 0 8px 0; font-size:18px}
  .dialog p{margin:6px 0 0 0; font-size:14px; color:var(--ink-dim)}
  .dialog .row{display:flex; gap:8px; margin-top:14px; flex-wrap:wrap}
  .dialog.success{box-shadow: 0 0 0 2px rgba(80,200,120,.18) inset}
  .dialog.warn{box-shadow: 0 0 0 2px rgba(216,67,21,.18) inset}
</style>
</head>
<body>
  <div class="wrap">
    <div class="head">
      <div class="title">
        <div class="mug">üç∫</div>
        <div>
          <h1>–ù–∞–π–¥–∏ –ø–∞—Ä—É ‚Äî ¬´–°–ª–∏–≤–æ—á–Ω–æ–µ –ø–∏–≤–æ¬ª</h1>
        </div>
      </div>
      <div class="controls">
        <button id="restart">–ù–∞—á–∞—Ç—å –∑–∞–Ω–æ–≤–æ</button>
      </div>
      <div class="hud" aria-live="polite" aria-atomic="true">
        <span class="pill" id="moves">–•–æ–¥—ã: 0/55</span>
        <span class="pill" id="time">–í—Ä–µ–º—è: 00:00</span>
        <span class="pill" id="pairs">–ü–∞—Ä—ã: 0/20</span>
      </div>
    </div>

    <main class="board" id="board" aria-label="–ò–≥—Ä–æ–≤–æ–µ –ø–æ–ª–µ"></main>
  </div>

  <!-- –û–≤–µ—Ä–ª–µ–π -->
  <div id="overlay" class="overlay is-hidden">
    <div id="dialog" class="dialog" role="dialog" aria-modal="true" aria-labelledby="dlg-title">
      <h2 id="dlg-title">–°–æ–æ–±—â–µ–Ω–∏–µ</h2>
      <p id="dlg-text">–¢–µ–∫—Å—Ç‚Ä¶</p>
      <div class="row">
        <button id="playAgain">–°—ã–≥—Ä–∞—Ç—å –µ—â—ë</button>
        <button id="closeOverlay" class="ok">–ó–∞–∫—Ä—ã—Ç—å</button>
      </div>
    </div>
  </div>

<script>
(function(){
  const ICONS = [
    'üç∫','üçª','üéÉ','üïØÔ∏è','ü¶â','üìö','üßπ','‚öóÔ∏è','üç´','üçé','ü™Ñ','üßô‚Äç‚ôÄÔ∏è','üï∑Ô∏è','ü™∂','üåï','ü¶á','üîÆ','üß§','ü´ô','üç™','üó∫Ô∏è','üß≠','üè∞','üß™','üìú','üï∞Ô∏è','üßµ'
  ];
  const CFG = { cols:5, rows:8, pairs:20 };
  const MOVES_LIMIT = 55;

  const board = document.getElementById('board');
  const restartBtn = document.getElementById('restart');
  const movesEl = document.getElementById('moves');
  const timeEl  = document.getElementById('time');
  const pairsEl = document.getElementById('pairs');

  const overlay = document.getElementById('overlay');
  const dialog  = document.getElementById('dialog');
  const dlgTitle= document.getElementById('dlg-title');
  const dlgText = document.getElementById('dlg-text');
  const btnAgain= document.getElementById('playAgain');
  const btnClose= document.getElementById('closeOverlay');

  let state = { deck:[], matched:0, moves:0, started:false, secs:0, over:false };
  let timer = null;

  function shuffle(a){ for(let i=a.length-1;i>0;i--){ const j=Math.floor(Math.random()*(i+1)); [a[i],a[j]]=[a[j],a[i]] } return a }
  function fmt(n){ return n<10? '0'+n : ''+n }
  function tick(){ state.secs++; timeEl.textContent = `–í—Ä–µ–º—è: ${fmt(Math.floor(state.secs/60))}:${fmt(state.secs%60)}` }
  function startTimer(){ if(timer) return; timer=setInterval(tick,1000) }
  function stopTimer(){ if(timer){ clearInterval(timer); timer=null } }

  function showOverlay({title, text, variant='success'}){
    dlgTitle.textContent = title;
    dlgText.innerHTML = text;
    dialog.classList.remove('success','warn');
    dialog.classList.add(variant);
    overlay.classList.remove('is-hidden');
    setTimeout(()=> btnAgain.focus(), 0);
  }
  function hideOverlay(){ overlay.classList.add('is-hidden'); }

  function buildDeck(){
    const base = ['üç∫','üçª'];
    const unique = Array.from(new Set(ICONS));
    const rest = shuffle(unique.filter(x=>!base.includes(x))).slice(0, CFG.pairs - base.length);
    const chosen = [...base, ...rest];
    return shuffle(chosen.flatMap(x=>[x,x]));
  }

  function updateHUD(){
    movesEl.textContent = `–•–æ–¥—ã: ${state.moves}/${MOVES_LIMIT}`;
    timeEl.textContent  = `–í—Ä–µ–º—è: ${fmt(Math.floor(state.secs/60))}:${fmt(state.secs%60)}`;
    pairsEl.textContent = `–ü–∞—Ä—ã: ${state.matched}/${CFG.pairs}`;
  }

  function render(){
    board.style.setProperty('--cols', CFG.cols);
    board.innerHTML='';
    state.deck.forEach((icon)=>{
      const card = document.createElement('button');
      card.className='card'; card.type='button';
      card.setAttribute('data-icon', icon);
      card.innerHTML = `
        <div class="inner">
          <div class="face front"></div>
          <div class="face back"><div class="emoji">${icon}</div></div>
        </div>`;
      card.addEventListener('click', ()=>flip(card));
      card.addEventListener('keydown', (e)=>{
        if(e.key==='Enter' || e.key===' '){ e.preventDefault(); flip(card); }
      });
      board.appendChild(card);
    });
    updateHUD();
  }

  function disableButton(el){
    el.classList.add('disabled');
    el.setAttribute('disabled','true');
    el.setAttribute('aria-disabled','true');
    el.tabIndex = -1;
  }

  let lock=false, first=null;
  function flip(card){
    if(state.over || lock || card.classList.contains('flipped') || card.classList.contains('matched')) return;
    if(!state.started){ state.started=true; startTimer(); }

    card.classList.add('flipped');
    if(!first){ first=card; return }

    const second = card; state.moves++;
    const a = first.getAttribute('data-icon');
    const b = second.getAttribute('data-icon');

    if(a===b){
      [first,second].forEach(c=>{ c.classList.add('matched'); disableButton(c); });
      state.matched++; first=null; updateHUD(); checkEnd();
    } else {
      lock=true;
      setTimeout(()=>{
        if(!state.over){ [first,second].forEach(c=> c.classList.remove('flipped')); }
        first=null; lock=false; updateHUD(); checkEnd();
      }, 650);
    }
    updateHUD();
  }

  function disableAll(){ Array.from(board.querySelectorAll('.card')).forEach(disableButton) }

  function checkEnd(){
    if(state.matched>=CFG.pairs){
      stopTimer(); state.over=true; disableAll();
      showOverlay({
        title:'üèÜ –ü–æ–±–µ–¥–∞!',
        text:`–í—Å–µ –ø–∞—Ä—ã —Å–æ–±—Ä–∞–Ω—ã.<br>–•–æ–¥—ã: <b>${state.moves}/${MOVES_LIMIT}</b><br>–í—Ä–µ–º—è: <b>${fmt(Math.floor(state.secs/60))}:${fmt(state.secs%60)}</b>`,
        variant:'success'
      });
      return;
    }
    if(state.moves>=MOVES_LIMIT){
      stopTimer(); state.over=true; disableAll();
      showOverlay({
        title:'‚õî –•–æ–¥—ã –∑–∞–∫–æ–Ω—á–∏–ª–∏—Å—å',
        text:'–ü–æ–ø—Ä–æ–±—É–π –µ—â—ë —Ä–∞–∑ ‚Äî –≤–æ–∑–º–æ–∂–Ω–æ, –≤ —ç—Ç–æ—Ç —Ä–∞–∑ –ø–æ–≤–µ–∑—ë—Ç –±–æ–ª—å—à–µ!',
        variant:'warn'
      });
    }
  }

  function reset(){
    hideOverlay(); stopTimer();
    state = { deck:buildDeck(), matched:0, moves:0, started:false, secs:0, over:false };
    render();
  }

  restartBtn.addEventListener('click', reset);
  btnAgain.addEventListener('click', reset);
  btnClose.addEventListener('click', hideOverlay);
  overlay.addEventListener('click', (e)=>{ if(e.target===overlay) hideOverlay(); });

  reset();
})();
</script>
</body>
</html>